<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Greendash Dashboard</title>
    <!-- Iconic Fonts -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="../vendors/iconic-fonts/font-awesome/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../vendors/iconic-fonts/flat-icons/flaticon.css">
    <link rel="stylesheet" href="../vendors/iconic-fonts/cryptocoins/cryptocoins.css">
    <link rel="stylesheet" href="../vendors/iconic-fonts/cryptocoins/cryptocoins-colors.css">
    <!-- Bootstrap core CSS -->
    <link href="http://cdn.bootstrapmb.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet">
    <!-- jQuery UI -->
    <link href="../assets/css/jquery-ui.min.css" rel="stylesheet">
    <!-- Page Specific CSS (Slick Slider.css) -->
    <link href="../assets/css/slick.css" rel="stylesheet">
    <!-- Greendash styles -->
    <link href="../assets/css/style.css" rel="stylesheet">
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="favicon.ico">

</head>

<body class="ms-body ms-aside-left-open ms-primary-theme ">


    <!-- Overlays -->
    <div class="ms-aside-overlay ms-overlay-left ms-toggler" data-target="#ms-side-nav" data-toggle="slideLeft"></div>

    <!-- 大页面左边导航 -->
    <aside id="ms-side-nav" class="side-nav fixed ms-aside-scrollable ms-aside-left">

        <!-- Logo -->
        <div id="logo" class="logo-sn ms-d-block-lg">
            <!-- logo的图片 -->
            <a class="pl-0 ml-0 text-center" href="index.html"> <img src="../assets/img/logo.png" alt="logo">
            </a>
        </div>

        <!-- 导航的一级菜单 -->
        <ul class="accordion ms-main-aside fs-14" id="side-nav-accordion">
            <!-- Dashboard -->
            <li class="menu-item">
                <a href="#" class="has-chevron" data-toggle="collapse" data-target="#dashboard" aria-expanded="false"
                    aria-controls="dashboard">
                    <span><i class="material-icons fs-16">dashboard</i>采购管理 </span>
                </a>
                <ul id="dashboard" class="collapse" aria-labelledby="dashboard" data-parent="#side-nav-accordion">
                    <li> <a href="./gongyingshangxinxi.html">供应商信息管理</a> </li>
                    <li> <a href="./yaopinxinxi.html">药品信息管理</a> </li>
                    <li> <a href="./add_caigoudan.html">采购单添加</a> </li>
                    <li> <a href="./caigoumingxi.html">采购明细管理</a> </li>
                </ul>
            </li>
            <li class="menu-item">
                <a href="#" class="has-chevron" data-toggle="collapse" data-target="#order-page" aria-expanded="false"
                    aria-controls="order-page">
                    <span><i class="fas fa-clipboard-list"></i>销售管理</span>
                </a>
                <ul id="order-page" class="collapse" aria-labelledby="order-page" data-parent="#side-nav-accordion">
                    <li> <a href="./add_xiaoshoudan.html">销售单添加管理</a> </li>
                    <li> <a href="./xiaoshoumingxi.html">销售明细管理</a> </li>
                </ul>
            </li>
            <li class="menu-item">
                <a href="#" class="has-chevron" data-toggle="collapse" data-target="#product-page" aria-expanded="false"
                    aria-controls="product-page">
                    <span><i class="fas fa-cannabis"></i>药店统计管理</span>
                </a>
                <ul id="product-page" class="collapse" aria-labelledby="product-page" data-parent="#side-nav-accordion">
                    <li> <a href="./rukutongji.html">入库统计</a> </li>
                    <li> <a href="./chukutongji.html">出库统计</a> </li>
                    <li> <a href="./kucunchaxun.html">库存查询</a> </li>
                </ul>
            </li>
            <li class="menu-item">
                <a href="#" class="has-chevron" data-toggle="collapse" data-target="#customer" aria-expanded="false"
                    aria-controls="customer">
                    <span><i class="fas fa-users"></i>人事管理</span>
                </a>
                <ul id="customer" class="collapse" aria-labelledby="customer" data-parent="#side-nav-accordion">
                    <li> <a href="add_yuangong.html">员工添加</a> </li>
                    <li> <a href="./yuangongguanli.html">员工管理</a> </li>
                </ul>
            </li>
            <li class="menu-item">
                <a href="#" class="has-chevron" data-toggle="collapse" data-target="#invoice" aria-expanded="false"
                    aria-controls="invoice">
                    <span><i class="fas fa-receipt"></i>打印管理</span>
                </a>
                <ul id="invoice" class="collapse" aria-labelledby="invoice" data-parent="#side-nav-accordion">
                    <li> <a href="./ruKuDan.html">入库单</a> </li>
                    <li> <a href="./chuKuDan.html">出库单</a> </li>
                </ul>
            </li>
            <li class="menu-item">
                <a href="#" class="has-chevron" data-toggle="collapse" data-target="#basic-elements"
                    aria-expanded="false" aria-controls="basic-elements">
                    <span><i class="material-icons fs-16">filter_list</i>系统管理</span>
                </a>
                <ul id="basic-elements" class="collapse" aria-labelledby="basic-elements"
                    data-parent="#side-nav-accordion">
                    <li> <a href="./xiuGaiMiMa.html">修改密码</a> </li>
                </ul>
            </li>
        </ul>
    </aside>
    <!-- 主体页面内容 -->
    <main class="body-content">
        <div id="app">
        <!-- 主题页面顶部导航 -->
        <nav class="navbar ms-navbar">
            <div class="ms-aside-toggler ms-toggler pl-0" data-target="#ms-side-nav" data-toggle="slideLeft">
                <span class="ms-toggler-bar bg-primary"></span>
                <span class="ms-toggler-bar bg-primary"></span>
                <span class="ms-toggler-bar bg-primary"></span>
            </div>
            <div class="logo-sn logo-sm ms-d-block-sm">
                <a class="pl-0 ml-0 text-center navbar-brand mr-0" href="index.html"><img
                        src="../assets/img/dashboard/greendash-logo-84x41.png" alt="logo"> </a>
            </div>
            <!-- 搜索 -->
            <!-- 退出登录 -->
         <div style="display:flex;align-content:center;">
            <div style="line-height:60px;font-size: 18px;"><span id="loginSuName">{{username}}</span>,欢迎你</div>
            <div id="outLogin"><a href="javascript:void(0);" id="logOut" @click="logout">退出登录</a></div>
         </div>



        </nav>

        <!-- 内容区域 -->
        <div class="ms-content-wrapper">
            <div class="row">
                <!-- 分页标 -->
                <div class="col-md-12 myadd">
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb pl-0">
                            <li class="breadcrumb-item"><a href="./index.html">首页</a></li>
                            <li class="breadcrumb-item"><a href="./yaopinxinxi.html">药品信息</a></li>
                        </ol>
                    </nav>
                    <button id="addGongYingShang" class="btn btn-success" data-toggle="modal"
                        data-target="#reminder-modal">添加供应商</button>
                </div>

                <!-- 方块下的表格 -->
                <div class="col-xl-12 col-md-12">
                    <div class="ms-panel">
                        <div class="ms-panel-body">
                            <div class="table-responsive">
                                <table class="mytable table table-hover thead-primary">
                                    <thead>
                                        <tr>
                                            <th>药品类别</th>
                                            <th>药品名称</th>
                                            <th>供应商</th>
                                            <th>单位</th>
                                            <th>保质期</th>
                                            <th>备注</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    <tr v-for="goods in goodsList">
                                        <td>{{goods.catelog_id}}</td>
                                        <td>{{goods.name}}</td>
                                        <td>{{goods.gys_id}}</td>
                                        <td>{{goods.danwei}}</td>
                                        <td>{{goods.baozhiqi}}</td>
                                        <td>{{goods.beizhu}}</td>

                                        <td><span class='btn_del' @click="del(goods.id)"><i class="far fa-trash-alt ms-text-danger ml-3" ></i></span></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 添加药品模态框 -->
        <div class="modal fade " id="reminder-modal" tabindex="-1" role="dialog" aria-labelledby="reminder-modal">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">

                    <div class="modal-header bg-secondary">
                        <h5 class="modal-title has-icon text-white">添加药品</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                    </div>
                    <form id="add_ypxx">
                        <div class="modal-body">
                            <div class="ms-form-group">
                                <label for="validationCustom01">药品类别</label>
                                <div class="input-group">
                                    <select class="form-control" id="validationCustom01" name="catelog_id" required="required" v-model="catelog_id">
                                        <option value="01">1</option>
                                        <option value="02">2</option>
                                        <option value="03">3</option>
                                        <option value="04">4</option>
                                        <option value="05">5</option>
                                        <option value="06">6</option>
                                        <option value="10">10</option>

                                    </select>
                                 </div>
                            </div>
                            <div class="ms-form-group">
                                <label>药品名称</label>
                                <input type="text" class="form-control" name="name" v-model="name"/>
                            </div>

                            <div class="ms-form-group">
                                <label for="validationCustom02">供应商</label>
                                <div class="input-group">
                                    <select class="form-control" id="validationCustom02" name="gys_id" required="required" v-model="gys_id">
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                        <option value="9">9</option>
                                        <option value="10">10</option>
                                    </select>
                                </div>
                            </div>

                            <div class="ms-form-group">
                                <label>单位</label>
                                <input type="text" class="form-control" name="danwei" v-model="danwei"/>
                            </div>

                            <div class="ms-form-group">
                                <label>保质期</label>
                                <input type="text" class="form-control" name="baozhiqi" v-model="baozhiqi"/>
                            </div>

                            <div class="ms-form-group">
                                <label>备注</label>
                                <input type="text" class="form-control" name="beizhu" v-model="beizhu"/>
                            </div>
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-light" data-dismiss="modal">关闭</button>
                            <button type="button" @click="add" class="add_ypxx_btn btn btn-secondary shadow-none" data-dismiss="modal">添加</button>
                        </div>

                    </form>

                </div>
            </div>
        </div>
        </div>
    </main>
    <!-- SCRIPTS -->
    <!-- Global Required Scripts Start -->
    <script src="../assets/js/jquery-3.3.1.min.js"></script>
    <script src="../assets/js/popper.min.js"></script>
    <script src="http://cdn.bootstrapmb.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
    <script src="../assets/js/perfect-scrollbar.js"> </script>
    <script src="../assets/js/jquery-ui.min.js"> </script>
    <!-- Global Required Scripts End -->

    <!-- Page Specific Scripts Start -->
    <script src="../assets/js/moment.js"> </script>
    <script src="../assets/js/jquery.webticker.min.js"> </script>
    <!--  <script src="../assets/js/Chart.bundle.min.js"> </script>-->
    <!--  <script src="../assets/js/Chart.Financial.js"> </script>-->
    <!--  <script src="../assets/js/table-line.js"> </script>-->
    <!--  <script src="../assets/js/index-chart.js"> </script>-->

    <script src="../assets/js/d3.v3.min.js"> </script>
    <script src="../assets/js/topojson.v1.min.js"> </script>
    <!--  <script src="../assets/js/datamaps.all.min.js"> </script>-->
    <!--  <script src="../assets/js/index-map.js"> </script>-->






    <!-- Page Specific Scripts End -->

    <!-- Greendash core JavaScript -->
    <script src="../assets/js/framework.js"></script>

    <!-- Settings -->
    <script src="../assets/js/settings.js"></script>
    <script src="../assets/js/vue.js"></script>
    <script src="../assets/js/axios.min.js"></script>

    <script type="text/javascript">



        var vm = new Vue({
            el:"#app",
            data:{
                goodsList:[],
                username:'',
                catelog_id:'',
                name:'',
                gys_id:'',
                danwei:'',
                baozhiqi:'',
                beizhu:'',
            },
            methods:{
                logout:function(){
                    //1、清除localStorage中的内容
                    localStorage.clear();
                    //2、刷新当前页面
                    window.location.reload();
                },
                add:function(){
                    //通过axios发送ajax请求
                    axios.post('/goodsAdd',`catelog_id=${this.catelog_id}&name=${this.name}&gys_id=${this.gys_id}&danwei=${this.danwei}&baozhiqi=${this.baozhiqi}&beizhu=${this.beizhu}`).then(
                        response => {
                            if(response.data.code == 200){//添加成功了
                                //刷新当前页面
                                window.location.reload();
                            }else{
                                alert(response.data.msg);
                            }
                        },
                        error => {console.log('失败了',error);}
                    )
                },
                del:function(id){
                    if(confirm("确定要删除吗?")) {
                        //发送ajax请求，将id 传给servlet
                        axios.post('/goodsDel',`id=${id}`).then(
                            response => {
                                if(response.data.code == 200){//删除成功了
                                    //刷新当前页面
                                    window.location.reload();
                                }else{
                                    alert(response.data.msg);
                                }
                            },
                            error => {console.log('失败了',error);}
                        )

                    }

                }
            },

            created:function(){

                //1、从localStorage中将用户信息取出来
                var obj = localStorage.getItem("user");//{"id":1,"name":"admin","status":1}
                if(obj != null) {
                    //将 obj={"id":1,"name":"admin","status":1} 转为 json对象
                    var user = $.parseJSON(obj) //将obj json字符串 转换为json对象
                    //2、将取出的信息 从中拿出用户名  赋值给username
                    this.username = user.name;

                    axios.get('/goodsList').then(
                        response => {
                            //拿到数据 ，赋值给goodsList
                            this.goodsList = response.data.data;
                        },
                        error => {console.log('请求失败了',error);}
                    )

                }else{//没有从localStorage中取到东西   用户没有登录
                    location.href = "./login.html";
                }


            }

        })
        $(function () {
           


            })



    </script>

</body>

</html>